# 如何处理逻辑回归中的缺失数据？

[机器学习](README-zh.md)

[回归](https://www.baeldung.com/cs/tag/regression) [训练](https://www.baeldung.com/cs/tag/training)

1. 简介

    [缺失数据](https://www.baeldung.com/cs/missing-vs-sparse-data)是指给定数据集中某些变量未存储（或不存在）的值或数据。此外，处理缺失数据至关重要，尤其是在[逻辑回归](https://www.baeldung.com/cs/gradient-descent-logistic-regression)中，以保持模型的准确性和可靠性。
    在本教程中，我们将探索不同的策略，并通过数字示例来说明每种方法。

2. 删除缺失数据
    一种简单的方法是删除缺失值。假设我们有一个数据集，其中的二元结果（0 或 1）代表客户是否购买了产品：

    | Customer ID | Purchase |
    |-------------|----------|
    | 1           | 1        |
    | 2           | 0        |
    | 3           | NA       |
    | 4           | 1        |

    删除缺失数据后，数据集将只有第 1、2 和 3 行：

    | Custom3er ID | Purchase |
    |-------------|----------|
    | 1           | 1        |
    | 2           | 0        |
    | 4           | 1        |

3. 估算
    估算可以填补缺失值。例如，如果我们有一个包含客户年龄的数据集，但其中一些年龄缺失，那么我们可以采用以下方法来填补缺失值：

    | Customer ID | Age |
    |-------------|-----|
    | 1           | 25  |
    | 2           | NA  |
    | 3           | 30  |
    | 4           | 22  |

    现在，我们用年龄列的平均值来填补缺失值，这样数据集就变成了

    | Customer ID | Age |
    |-------------|-----|
    | 1           | 25  |
    | 2           | 26.5  |
    | 3           | 30  |
    | 4           | 22  |

4. 多重估算
    多重估算涉及创建多个数据集，每个数据集都有不同的缺失数据估算值。然后分别对这些数据集进行分析，并将结果合并起来，以提供更可靠的估计值。
    让我们举一个假设的例子，数据集代表患者是否对治疗有反应以及他们的年龄，其中一些年龄值缺失：

    | Patient ID | Age | Response |
    |------------|-----|----------|
    | 1          | 45  | 1        |
    | 2          | 32  | 0        |
    | 3          | NA  | 1        |
    | 4          | 50  | 1        |
    | 5          | NA  | 0        |

    在这种情况下，年龄列中有 3 号和 5 号患者的缺失值。多重估算过程包括创建多个数据集，每个数据集都有不同的缺失年龄估算值。让我们生成三个估算数据集。

    估算数据集 1：

    | Patient ID | Age | Response |
    |------------|-----|----------|
    | 1          | 45  | 1        |
    | 2          | 32  | 0        |
    | 3          | 40  | 1        |
    | 4          | 50  | 1        |
    | 5          | 47  | 0        |

    估算数据集 2：

    | Patient ID | Age | Response |
    |------------|-----|----------|
    | 1          | 45  | 1        |
    | 2          | 32  | 0        |
    | 3          | 42  | 1        |
    | 4          | 50  | 1        |
    | 5          | 44  | 0        |

    输入数据集 3：

    | Patient ID | Age | Response |
    |------------|-----|----------|
    | 1          | 45  | 1        |
    | 2          | 32  | 0        |
    | 3          | 38  | 1        |
    | 4          | 50  | 1        |
    | 5          | 41  | 0        |

    每个估算数据集都有不同的 3 号和 5 号患者的估计年龄。随后，将分别对这些数据集进行分析（例如，在每个数据集上运行相同的分析），以获得多组结果。
    最后，统计技术（如平均或合并这些分析得出的估计值）可提供更可靠的总体估计值，以考虑缺失数据带来的不确定性。
5. 高级估算技术
    K-nearest neighbors（[KNN](https://www.baeldung.com/cs/k-nearest-neighbors)）估算是一种高级技术，用于通过考虑相邻数据点的值来估算缺失值。

    在根据客户 1 和 3 的年龄计算客户 2 的缺失年龄时，下面是一个使用简化数据集的示例：

    | Custom?r ID | Age |
    |-------------|-----|
    | 1           | 45  |
    | 2           | NA  |
    | 3           | 50  |
    | 4           | 30  |
    | 4           | 40  |

    在 K 近邻估算中，缺失值是根据其近邻值估算的。例如，假设我们决定使用客户 1 和 3 的年龄作为客户 2 的近邻。
    如果我们根据客户 1 和客户 3 的年龄使用简单的平均法，则会出现以下结果：

    (1)  \[\begin{equation*}\text { Average Age }=\frac{\text { Age of Customer 1+Age of Customer 3 }}{2}\end{equation*}\]

    平均年龄 = $\frac{45 + 50}{2} = 47.5$

    因此，利用客户 1 和 3 的年龄进行简单平均，我们可以将客户 2 的年龄估算为 47.5 岁。

6. 创建缺失数据指标
    我们可以为缺失数据创建一个指标变量来代替估算。例如，如果我们有一个包含收入信息的数据集，但某些值缺失，那么我们可以创建一个指标变量，当收入缺失时为 1，否则为 0：

    | Customer ID | Income | Income_Missing |
    |-------------|--------|----------------|
    | 1           | 50000  | 0              |
    | 2           | NA     | 1              |
    | 3           | 60000  | 0              |
    | 4           | 45000  | 0              |

7. 对观察值进行加权
    逻辑回归中处理缺失数据的另一种方法是为具有完整数据的观测值分配权重。这样，缺失值的观测值对模型的影响就较小。
    例如，如果我们有一个数据集，其中的二元结果变量（0 或 1）表示学生是否通过了考试，那么我们可以为信息完整的观测值分配更高的权重：

    | Student ID | Study Hours | Exam Result |
    |------------|-------------|-------------|
    | 1          | 10          | 1           |
    | 2          | Nan         | 0           |
    | 3          | 8           | 1           |
    | 4          | 12          | 0           |

    在分配权重时，可以将信息完整的观测值的权重定为 1，而将信息缺失的观测值的权重定为较低的权重：

    | Student ID | Study Hours | Exam Result | Weight |
    |------------|-------------|-------------|--------|
    | 1          | 10          | 1           | 1      |
    | 2          | NA          | 0           | 0.8    |
    | 3          | 8           | 1           | 1      |
    | 4          | 12          | 0           | 1      |

8. 结论
    总之，处理逻辑回归中的缺失数据是一项细致入微的工作，需要深思熟虑。不同的策略，如删除、估算、创建指标、观察值加权和多重估算，提供了一系列选择。
    策略的选择取决于缺失的类型、数据集特征以及对逻辑回归模型有效性和性能的潜在影响。
