# 深度神经网络： 填充

[深度学习](https://www.baeldung.com/cs/category/ai/deep-learning)

[图像处理](https://www.baeldung.com/cs/tag/image-processing) [神经网络](https://www.baeldung.com/cs/tag/neural-networks)

1. 简介

    在本教程中，我们将介绍一种广泛使用的机器学习技术--"填充"，它可以处理输入数据，提高模型的性能和准确性。我们将特别介绍填充，解释其用法，强调其重要性，并举例说明其工作原理。

2. 什么是填充？

    在机器学习和神经网络中，[卷积滤波器](https://www.baeldung.com/cs/ai-convolutional-neural-networks)被应用于图像，以便从中提取有用的信息，如图案、边缘和角落。由于 $n \times n$ 图像与 $f \times f$ 过滤器卷积，因此输出维度为 $n-f + 1 \times n - f +1$。由于卷积操作，图像会缩小，尤其是当神经网络很深，有很多层的时候。此外，中心像素参与了大量的卷积区域，相比之下，角落像素参与的次数较少，在对矩阵进行卷积运算时参与的程度也不高。这会导致输入图片的边缘丢失相关信息。填充就是为了解决这些问题。

    填充是一种技术，可确保输入数据在深度学习模型的每个阶段进行每次卷积运算后，都具有模型预期的精确大小和形状。因此，可以通过在输入数据中添加额外元素（如零）来确保输入数据符合模型的规格：

    ![填充技术](pic/padding.webp)

3. 不同类型的填充

    机器学习中使用的填充主要有三种：相同填充、有效填充和因果填充，其中最常用的是相同填充。

    相同填充： 这种类型的填充会在输入 $n \times n$ 图像的顶部、底部、左侧和右侧添加相同数量的元素（n/2），通常是零，从而使输出大小与输入大小相同。

    有效填充： 这种填充是计算输入矩阵的有效元素，而不是添加新元素。因此，输出大小小于输入大小。有效填充表示没有填充，所有比例都是准确的，因此滤波器能完全覆盖输入图片。

    因果填充： 这类填充用于[序列到序列模型](https://en.wikipedia.org/wiki/Seq2seq)和时间序列预测，基本上与一维卷积层配合使用。因果填充会在数据开始时添加元素，这也有助于预测早期时间步的值。

    请注意，填充的选择会极大地影响模型的性能和准确性。

4. 为什么使用填充？

    填充是最关键的机器学习技术之一，因为它允许修改输入大小，以符合神经网络的要求。在应用任何卷积滤波器之前，它都会在输入矩阵中添加元素，因此有助于防止任何信息丢失，尤其是图像边缘的信息丢失。此外，填充还有助于防止每次卷积操作后的图像压缩。

    最后，它有助于保持输入数据的空间关系和特征，并能显著影响模型的整体性能。

5. 优缺点

    填充有几个优点，也有一些缺点。

    其中一个重要的优点是，填充已被证明可以提高模型的性能。它有助于保留图像中可能丢失的重要方面，从而揭示可能在输出中发挥重要作用的有用关系。此外，通过添加额外的元素，它还有助于保持输入长度的一致性，并简化了数据处理方式，无需额外的预处理步骤来处理不同长度的输入数据。

    另一方面，填充会增加模型的计算复杂度，因为需要更多的操作和处理步骤。此外，它还增加了额外的元素，从而增加了计算成本。最后，在某些情况下，填充似乎会导致过度拟合。

6. 结论

    在本教程中，我们介绍了填充技术，这是一种用于图像处理、序列到序列模型、时间序列预测和语音处理的机器学习技术，有助于提高模型性能和简化数据处理。我们特别介绍了填充，通过一个简短的例子强调了它，介绍了最常见的填充类型，并分析了它的重要性及其主要优点和局限性。
