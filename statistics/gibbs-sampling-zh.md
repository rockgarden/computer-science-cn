# 吉布斯采样简介

- [ ] [Introduction to Gibbs Sampling](https://www.baeldung.com/cs/gibbs-sampling)

1. 简介

    本文将介绍一种名为吉布斯抽样的抽样技术。在统计学中，抽样是从统计群体中选择一个子集来估计整个群体特征的技术。通过抽样，可以加快数据收集的速度，从而在无法测量整个群体的情况下提供洞察力。

    从特定多元概率分布中获取样本的一种抽样技术是吉布斯抽样。

2. 什么是抽样？

    如上所述，抽样是从给定总体中选择元素子集的一种方法。通过使用适当的抽样方法，我们可以选择代表整个群体的较小子集。

    之后，我们就可以利用这个子集开展工作，所有适用于子集的结论也将适用于整个人群。

    其中一些抽样方法是

    - 随机抽样
    - 间隔抽样
    - [分层抽样](https://www.baeldung.com/cs/ml-stratified-sampling)
    - 聚类抽样

    抽样有许多不同的应用。基本上，在每项需要用数据子集得出近似值的任务中，我们都需要进行某种抽样。

    例如，在对城市进行调查时，我们需要抽取一组能代表整个人口的样本。在机器学习中，当我们需要将数据分成训练集和验证集时，一种方法就是[分层交叉验证](https://www.baeldung.com/cs/k-fold-cross-validation#2-stratified-k-fold-cross-validation)，也就是分层抽样。

    在工厂中，食品技术专家可以对几种产品进行抽样，并根据它们的质量来确定整个产品库存和其他产品的质量。

3. 吉布斯取样

    吉布斯抽样是从两个或两个以上维度的概率分布或多元分布中进行抽样的一种方法。它是[马尔可夫链蒙特卡罗](https://www.baeldung.com/cs/markov-chain-monte-carlo)的一种方法，这意味着它是一种依赖性采样算法。因此，如果我们需要独立样本，通常会从一开始就舍弃一些样本，因为它们可能无法准确代表所需的分布。

    吉布斯抽样的要点在于，给定一个多变量分布，从条件分布中抽样比从联合分布中抽样更简单。例如，吉布斯采样建议从两个条件分布 $P(x| y)$ 和 $P(y| x)$ 中采样，而不是直接从联合分布 $P(x, y)$ 中采样。

    对于联合分布 P(x,y)，我们从随机样本 $(x^{(0)}, y^{(0)})$ 开始。然后，我们从条件分布 $P(x| y^{(0)})$ 中抽取 $x^{(1)}$，从条件分布 $P(y| x^{(1)})$ 中抽取 $y^{(1)}$。类似地，我们从 $P(x| y^{(k-1)})$ 中抽取 $x^{(k)}$，从 $P(y| x^{(k)})$ 中抽取 $y^{(k)}$。

4. 吉布斯采样定义

假设我们想从联合分布 $P(x_{1}, x_{2}, ..., x_{d})$中获得 ${X} = (x_{1}, x_{2}, ..., x_{d})$ 的 n 个样本。我们把第 i 个样本记为 ${X}^{(i)} = (x_{1}^{(i)}, x_{2}^{(i)}, ..., x_{d}^{(i)})$。吉布斯采样的算法是：


1. 吉布斯抽样示例

为了更好地解释这种方法，我们将举一个简单的例子。假设我们有两个事件 A 和 B：

P(A\, and\, B) = 0.2（两个事件都会发生）
P(A\ and\, not\, B) = 0.4（只有事件 A 会发生）
P（not\, A\, and\, B）= 0.3（只有事件 B 会发生）
P(not\, A\, and\, not\, B) = 0.1（A 和 B 都不会发生）
假设我们想从上述联合分布中采样。我们需要生成一个成对序列（x, y），其中 x, y \in \{0, 1\}.  例如，(1, 0) 表示只有事件 A 发生了。

当然，还有一种从上述联合分布中取样的简单方法，即取一个单位区间并将其分为四部分，每部分的面积等于上述概率。

例如，我们可以生成一个介于 0 和 1 之间的随机数 n。如果 n 介于 0 和 0.2 之间，那么我们的样本就是（1，1）；如果 n 介于 0.2 和 0.6 之间，那么我们的样本就是（1，0）；其他情况也是如此：

单位间隔
对于这个简单的例子，单位区间法比吉布斯抽样法更方便，但对于一些更复杂的例子，尤其是连续分布，我们就不能使用这种方法了。

5.1. 吉布斯抽样中的条件分布

在吉布斯抽样法中，我们需要计算条件分布 P(A| B) 和 P(B| A)。例如，为了计算 P(A|B=1)，我们将 P(A\, and\, B) = 0.2 和 P(not\, A\, and\, B) = 0.3 的值归一化，得到它们的总和 0.5：

P(A=1| B=1) = 0.4
P(A=0| B=1) = 0.6
同样，对于 P(A | B=0)，我们有


P(A=1| B=0) = 0.8
P(A=0| B=0) = 0.2
P(B| A) 的值为


P(B=1| A=1) = 0.333
p(b=0| a=1) = 0.666
P(B=1| A=0) = 0.75
p(b=0| a=0) = 0.25


知道所有条件分布后，我们就可以开始使用吉布斯抽样算法了。假设初始随机样本为 (x^{(0)}, y^{(0)}) = (1, 0)。现在我们需要从条件分布 P(x| y^{(0)}) = P(x| 0) 对 x^{(1)} 进行采样。由上可知，x^{(1)} = 1 的概率为 0.8，x^{(1)} = 0 的概率为 0.2。假设我们对 1 或 x^{(1)} = 1 进行了采样。




现在，我们需要从条件分布 P(y| x^{(1)}) = P(y| 1) 对 y^{(1)} 进行采样。由上可知，y^{(1)} = 1 的概率为 0.333，y^{(1)} = 0 的概率为 0.666。假设我们取样 1 或 y^{(1)} = 1。这意味着我们的第二个样本等于 (1，1)，我们的样本集目前是 S = \{(1, 0), (1, 1)\}。




之后，我们继续对其他元素进行采样，直到集合 S 的所有元素都没有生成为止。




6. 结论




在本文中，我们解释了采样一词的含义。我们的主要目标是用正式的定义、简单的解释和简单的例子来解释吉布斯采样。当联合分布不明确或难以直接抽样时，吉布斯抽样非常有用。不过，每个变量的条件分布是已知的，因此更容易进行抽样。
